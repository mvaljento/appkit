import{generateNonce as C,AuthClient as T}from"@walletconnect/auth-client";import{Web3Modal as q}from"@web3modal/standalone";var x=Object.defineProperty,D=Object.defineProperties,N=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,g=(t,e,a)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,_=(t,e)=>{for(var a in e||(e={}))V.call(e,a)&&g(t,a,e[a]);if(I)for(var a of I(e))R.call(e,a)&&g(t,a,e[a]);return t},z=(t,e)=>D(t,N(e)),v=(t,e,a)=>{if(!e.has(t))throw TypeError("Cannot "+a)},r=(t,e,a)=>(v(t,e,"read from private field"),a?a.call(t):e.get(t)),o=(t,e,a)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,a)},p=(t,e,a,h)=>(v(t,e,"write to private field"),h?h.call(t,a):e.set(t,a),a),d=(t,e,a)=>(v(t,e,"access private method"),a),n,i,c,l,w,P,u,m,f,k;class G{constructor(e){o(this,w),o(this,u),o(this,f),o(this,n,void 0),o(this,i,void 0),o(this,c,void 0),o(this,l,void 0),p(this,n,e),d(this,w,P).call(this),d(this,u,m).call(this)}async signIn(e){const{chainId:a,statement:h,aud:b,domain:y}=e,M=a??"eip155:1",E=b??location.href,S=y??location.host;return new Promise(async(A,j)=>{r(this,l)||await d(this,u,m).call(this);const O=r(this,i).subscribeModal(s=>{s.open||(O(),j(new Error("Modal closed")))});r(this,l).once("auth_response",({params:s})=>{O(),r(this,i).closeModal(),s.result?A({valid:!0,address:s.result.p.iss.split(":")[4],cacao:s.result}):j(new Error(s.message))});const{uri:W}=await r(this,l).request({aud:E,domain:S,chainId:M,type:"eip4361",nonce:C(),statement:h});W&&await r(this,i).openModal({uri:W,standaloneChains:[M]})})}}n=new WeakMap,i=new WeakMap,c=new WeakMap,l=new WeakMap,w=new WeakSet,P=function(){const{modalOptions:t,projectId:e}=r(this,n);p(this,i,new q(z(_({},t),{enableAuthMode:!0,walletConnectVersion:2,projectId:e})))},u=new WeakSet,m=async function(){return!r(this,c)&&typeof window<"u"&&p(this,c,d(this,f,k).call(this)),r(this,c)},f=new WeakSet,k=async function(){p(this,l,await T.init({metadata:r(this,n).metadata,projectId:r(this,n).projectId}))};export{G as Web3ModalAuth};
